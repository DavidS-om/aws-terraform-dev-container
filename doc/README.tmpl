{{- defineDatasource "config" .Env.README_YAML | regexp.Replace ".*" "" -}}
{{- defineDatasource "includes" .Env.README_INCLUDES | regexp.Replace ".*" "" -}}

<!--
  ** DO NOT EDIT THIS FILE
  **
  ** 1) Make all changes to `doc/README.yaml`
  ** 2) Run `make doc/build` to rebuild this file
  **
-->

{{ if has (ds "config") "logo" }}
![logo]({{ (ds "config").logo }})
{{end}}

<!-- SHIELDS -->
{{ if has (ds "config") "shields" }}
{{ range $shield := (ds "config").shields }}{{ printf "[![%s](%s)](%s)" $shield.name $shield.image $shield.url }}{{end}}
{{end}}

<!-- TITLE & DESCRIPTION -->
# {{ (ds "config").name }}

{{ (ds "config").description }}

<!-- SCREENSHOTS -->
{{ if has (ds "config") "screenshots" }}
## Screenshots

<details open>
  <summary>Expand</summary>

{{ range $screenshot := (ds "config").screenshots }}
| ![{{ $screenshot.label }}]({{ $screenshot.url }}) |
|:--:|
| *{{ $screenshot.caption }}* |
{{ end }}
</details>
{{ end }}

## Table of Contents

{{ $c := ds "config" }}

{{ if has (ds "config") "usage" }}{{ $usage := $c.usage }}{{ if ne $usage "" }} - [Usage](#usage) {{end}}{{end}}
{{ if has (ds "config") "prerequisites" }}{{ $prerequisites := len $c.prerequisites }}{{ if gt $prerequisites 0 }} - [Prerequisites](#prerequisites) {{end}}{{end}}
{{ if has (ds "config") "installation" }}{{ $installation := $c.installation }}{{ if ne $installation "" }} - [Installation](#installation) {{end}}{{end}}
{{ if has (ds "config") "testing" }}{{ $testing := $c.testing }}{{ if ne $testing "" }} - [Testing](#testing) {{end}}{{end}}
{{ if has (ds "config") "deployment" }}{{ $deployment := $c.deployment }}{{ if ne $deployment "" }} - [Deployment](#deployment) {{end}}{{end}}
{{ if has (ds "config") "tasks" }}{{ $tasks := len $c.tasks }}{{ if gt $tasks 0 }} - [Tasks](#tasks) {{end}}{{end}}
{{ if has (ds "config") "references" }}{{ $references := len $c.references }}{{ if gt $references 0 }} - [References](#references) {{end}}{{end}}
{{ if has (ds "config") "license" }}{{ $license := $c.license }}{{ if ne $license "" }} - [License](#license) {{end}}{{end}}
{{ if has (ds "config") "copyright" }}{{ $copyright := $c.copyright }}{{ if ne $copyright "" }} - [Copyright](#copyright) {{end}}{{end}}

<!-- USAGE -->
{{ if has (ds "config") "usage" }}
## Getting started

{{ (ds "config").usage }}
{{ end }}

<!-- PREREQUISITES -->
{{ if has (ds "config") "prerequisites" }}
## Prerequisites

{{ range $prerequisite := (ds "config").prerequisites }}{{ printf "- [%s](%s) - %s\n" $prerequisite.name $prerequisite.url $prerequisite.description }}{{end}}
{{end}}

<!-- INSTALLATION -->
{{ if has (ds "config") "installation" }}
## Installation

<details open>
  <summary>Expand</summary>

{{ (ds "config").installation }}
</details>
{{end}}

<!-- TESTING -->
{{ if has (ds "config") "testing" }}
## Testing

<details>
  <summary>Expand</summary>

{{ (ds "config").testing }}
</details>
{{end}}

<!-- DEPLOYMENT -->
{{ if has (ds "config") "deployment" }}
## Deployment

<details>
  <summary>Expand</summary>

{{ (ds "config").deployment }}
</details>
{{end}}

<!-- INCLUDE OTHER DOCS -->
{{ if has (ds "config") "include" }}
{{ range $file := (datasource "config").include -}}
{{ (include "includes" $file) }}
{{- end }}
{{- end }}

<!-- TASKS -->
{{ if has (ds "config") "tasks" }}
## Tasks

<details open>
  <summary>Collapse</summary>

{{ range $task := (ds "config").tasks }}{{ printf "* %s - %s - %s\n" $task.status $task.name $task.description }}{{end}}

</details>
{{end}}

<!-- REFERENCES -->
{{ if has (ds "config") "references" }}
## References

<details open>
  <summary>Expand</summary>

{{ range $ref := (ds "config").references }}{{ printf "* [%s]%s - %s\n" $ref.name $ref.url $ref.description }}{{end}}

</details>
{{end}}

<!-- LICENSE -->
{{ if has (ds "config") "license" }}
## License

{{ (ds "config").license }}
{{ end }}

<!-- COPYRIGHT -->
{{ if has (ds "config") "copyright" }}
## Copyright

{{ (ds "config").copyright }}
{{ end }}

<!-- LINKS -->
{{ if has (ds "config") "links" }}
{{ range $link := (ds "config").links }}{{ printf "[%s]: %s\n" $link.name $link.url }}{{end}}
{{end}}
